<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bind9 DNS</title>
    <script src="b.js"></script>
    <link rel="icon" type="image/x-icon" href="icon.svg">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }
        body { background-color: #0f172a; color: #f8fafc; min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 2rem 1rem; }
        .container { width: 100%; max-width: 850px; }
        header { text-align: center; margin-bottom: 2.5rem; }
        h1 { font-size: 2rem; font-weight: 800; }
        .text-indigo { color: #6366f1; }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 1.5rem; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.3); }
        .grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; margin-bottom: 1.5rem; }
        @media (min-width: 768px) { .grid { grid-template-columns: 1fr 1fr; } }
        label { display: block; font-size: 0.7rem; font-weight: 700; text-transform: uppercase; color: #94a3b8; margin-bottom: 0.5rem; }
        input { width: 100%; background: #0f172a; border: 1px solid #334155; color: white; padding: 0.8rem; border-radius: 0.75rem; outline: none; }
        input:focus { border-color: #6366f1; }
        button.btn-primary { width: 100%; background: #4f46e5; color: white; border: none; padding: 1rem; border-radius: 0.75rem; font-weight: 700; cursor: pointer; transition: 0.2s; }
        button.btn-primary:hover { background: #6366f1; transform: translateY(-1px); }
        .tab-container { display: flex; background: #0f172a; padding: 0.3rem; border-radius: 0.8rem; border: 1px solid #334155; margin-bottom: 1rem; }
        .tab-btn { flex: 1; background: transparent; border: none; color: #64748b; padding: 0.6rem; font-size: 0.7rem; font-weight: 700; border-radius: 0.6rem; cursor: pointer; }
        .tab-btn.active { background: #1e293b; color: white; }
        .output-box { position: relative; }
        .btn-copy { position: absolute; top: 0.5rem; right: 0.5rem; background: #334155; color: #818cf8; border: none; padding: 0.4rem 0.8rem; border-radius: 0.4rem; font-size: 0.6rem; font-weight: 800; cursor: pointer; }
        pre { background: #020617; padding: 1.25rem; border-radius: 1rem; overflow-x: auto; font-family: 'Consolas', monospace; font-size: 0.8rem; line-height: 1.5; color: #cbd5e1; border: 1px solid #1e293b; min-height: 100px; white-space: pre-wrap; word-break: break-all; }
        .hidden { display: none; }
        .custom-alert { position: fixed; top: 1rem; right: 1rem; background: #10b981; color: white; padding: 0.8rem 1.5rem; border-radius: 0.5rem; display: none; z-index: 100; font-weight: bold; }
        .warning { background: #450a0a; border: 1px solid #991b1b; padding: 1rem; border-radius: 0.75rem; margin-bottom: 1rem; font-size: 0.8rem; color: #fecaca; }
    </style>
</head>
<body>
    <div id="copyAlert" class="custom-alert">Copied!</div>
    <div class="container">
        <header>
            <h1>Bind9 <span class="text-indigo">DNS</span></h1>
        </header>

        <div class="glass">
            <div class="warning">
                <strong>INFO:</strong> Aduhai malass nyoo...
            </div>
            <div class="grid">
                <div>
                    <label>Nama Domain</label>
                    <input type="text" id="domain" value="michellino.tyz" placeholder="domain.com">
                </div>
                <div>
                    <label>IP Server</label>
                    <input type="text" id="ip" value="172.16.117.105" placeholder="1.2.3.4">
                </div>
            </div>
            <button onclick="generate()" class="btn-primary">Generate Clean Code</button>
        </div>

        <div id="res" class="hidden">
            <div class="tab-container">
                <button id="t1" onclick="tab('i')" class="tab-btn active">STEP 1: INSTALL</button>
                <button id="t2" onclick="tab('c')" class="tab-btn">STEP 2: CONFIG</button>
            </div>
            
            <div id="si" class="output-box">
                <button onclick="cp('oi')" class="btn-copy">COPY</button>
                <pre id="oi"></pre>
            </div>

            <div id="sc" class="output-box hidden">
                <button onclick="cp('oc')" class="btn-copy">COPY</button>
                <pre id="oc"></pre>
            </div>
        </div>
    </div>

    <script>
        const $ = id => document.getElementById(id);
        
        function tab(t){
            const isInstall = t === 'i';
            $('t1').classList.toggle('active', isInstall);
            $('t2').classList.toggle('active', !isInstall);
            $('si').classList.toggle('hidden', !isInstall);
            $('sc').classList.toggle('hidden', isInstall);
        }

        const pad = (text, length) => String(text).padEnd(length, ' ');

        function generate(){
            const d = $('domain').value.trim(), ip = $('ip').value.trim();
            if(!d || !ip) return;

            const p = ip.split('.');
            if(p.length !== 4) return;

            const rvZone = `${p[2]}.${p[1]}.${p[0]}.in-addr.arpa`;
            const df = d.split('.')[0];
            const serial = new Date().toISOString().slice(0,10).replace(/-/g,'') + '01';
            
            $('oi').textContent = `apt update && apt install bind9 dnsutils -y\ncp /etc/bind/named.conf.local /etc/bind/named.conf.local.bak`;
            
            const zoneContent = (isRev = false) => `\\$TTL    604800
@       IN      SOA     ${d}. root.${d}. (
                        ${pad(serial, 12)} ; Serial
                        ${pad('604800', 12)} ; Refresh
                        ${pad('86400', 12)} ; Retry
                        ${pad('2419200', 12)} ; Expire
                        ${pad('604800 )', 12)} ; Negative Cache TTL
;
@       IN      NS      ${d}.
${isRev ? pad(p[3], 8) : pad('@', 8)}IN      ${isRev ? 'PTR     ' + d + '.' : 'A       ' + ip}
${isRev ? '' : pad('www', 8) + 'IN      A       ' + ip}`;

            $('oc').textContent = `cat <<EOF > /etc/bind/named.conf.local
zone "${d}" {
    type master;
    file "/etc/bind/db.${df}";
};

zone "${rvZone}" {
    type master;
    file "/etc/bind/db.rev";
};
EOF

cat <<EOF > /etc/bind/db.${df}
${zoneContent(false)}
EOF

cat <<EOF > /etc/bind/db.rev
${zoneContent(true)}
EOF

echo "nameserver ${ip}" > /etc/resolv.conf

named-checkconf
named-checkzone ${d} /etc/bind/db.${df}
named-checkzone ${rvZone} /etc/bind/db.rev

systemctl restart bind9
systemctl status bind9 --no-pager
nslookup ${d}`;
            
            $('res').classList.remove('hidden');
        }

        function cp(id){
            const text = $(id).textContent;
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            
            const alert = $('copyAlert');
            alert.style.display = 'block';
            setTimeout(() => { alert.style.display = 'none'; }, 2000);
        }
    </script>
</body>
</html>
